/**
 * modules-index
 */
var http = require('http');
// When installed with NMP, add-on modules are referenced
// in the same way as built-in modules.
var director = require("director");
var mustache = require("mustache");
var WebSocketServer = require('websocket').server;

// Instead of emitting the markup directly, we'll use this variable to
// store a template for mustache. In later examples you'll load the 
// template from disk.
var template = '<!DOCTYPE html>\n'
	+ '<html>\n'
	+ '<head>\n'
	+ '<title>Modules Test</title>\n'
	+ '<head>\n'
	+ '<body>\n'
	+ 'Director is {{director_status}}<br />\n'
	+ 'Mustache is {{mustache_status}}<br />\n'
	+ 'WebSocket-Node is {{socket_status}}<br />\n'
	+ '<body>\n'
	+ '<html>';

var dict = {
	// This object restores the results of a few simple tests,
	// which confirm all modules loaded correctly.
    'director_status': director.http.Router ? 'working' : 'broken',
    'mustache_status': mustache.to_html ? 'working' : 'broken',
    'socket_status': typeof WebSocketServer !== 'undefined' ? 'working' : 'broken'
}

// Mustache is the only module this example uses
var html = mustache.to_html(template, dict);

http.createServer(function(request, response) {
	response.writeHead(200);
	response.write(html);
	response.end();
}).listen(8080);